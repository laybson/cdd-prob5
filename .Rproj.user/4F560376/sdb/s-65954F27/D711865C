{
    "collab_server" : "",
    "contents" : "---\ntitle: \"speed-dating\"\nauthor: \"laybson\"\ndate: \"26 de julho de 2018\"\noutput:  \n    html_document:\n    df_print: paged\ntheme: sandstone\n---\n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(viridis)\nlibrary(broom)\nlibrary(modelr)\nlibrary(GGally)\nlibrary(caret)\nlibrary(broom)\nlibrary(plotly)\nlibrary(knitr)\nlibrary(DT)\ntheme_set(theme_bw())\n```\n\n```{r}\ndata_sd <- read.csv(\"speed-dating/speed-dating.csv\")\ndata_sd <- data_sd %>%\n  mutate(age_diff = age_o-age)\n```\n\n## Ser divertido é ser atraente?\n\nÉ de saber popular que as pessoas se sentem mais atraídas por pessoas que elas consideram divertidas. Isso faz sentido, uma vez que rir faz bem. Mas será que isso reflete a realidade?\n\nUtilizaremos dados advindos de um [estudo](http://faculty.chicagobooth.edu/emir.kamenica/documents/genderDifferences.pdf) feito por professores da Columbia Business School, onde 310 pessoas participaram de 5000 encontros relâmpagos de 4 minutos, e ao final responderam um questionário onde davam notas de 1 a 10 em características dos parceiros, como: aparência, sinceridade, inteligência, diversão, ambição e interesses em comum. Também davam uma nota geral representando o quanto gostou da pessoa, e uma outra representando a probabilidade da receptividade dela quanto a você, além de responder se interesse de a encontrar novamente.\n\n\n\n```{r message=FALSE}\ndados <- data_sd %>%\n  mutate(from = as.numeric(factor(from)),\n         gender = as.numeric(factor(gender)),\n         samerace = as.numeric(factor(samerace)))\n```\nOs dados obtidos correlacionam-se da seguinte forma:\n\n```{r}\ndata_sd %>% \n  select(like,fun,amb,attr,\n         sinc,intel,shar) %>% \n  na.omit() %>%\n  ggcorr(palette = \"PuBu\", label = TRUE,\n       label_size = 4, nbreaks = 9)\n```\n\nVemos que aparentemente os atributos que melhor se relacionam com a variável gostar, nesse encontros rápidos, são diversão, aparência e interesses em comum. Diversão também mostra certa correlação com aparência e interesses em comum.\n\n\nAssim se distribui as notas refentes a o quão divertidos os participantes consideraram o seu parceiro:\n\n\n```{r}\ndata_sd %>% \n    ggplot(aes(x = fun)) + \n    geom_histogram(bins = 10, fill = \"white\", color = \"blue\") +\n    labs(x= \"Divertido\", y = \"Frequência\")\n```\n\nO histograma acima mostra que a maior parte das pessoas deu notas medianas, entre 5 e 8, para a capacidade de seus parceiros em os divertir.\n\nAbaixo, como se distribui as notas do quanto gostaram da outra pessoa.\n\n```{r}\ndata_sd %>% \n    ggplot(aes(x = like)) + \n    geom_histogram(bins = 10, fill = \"white\", color = \"blue\") +\n    labs(x= \"Quanto gostou\", y = \"Frequência\")\n```\n\nA distribuição é semelhante à de diversão. \n\n\nVamos responder nossa pergunta utilizando um modelo de regressão linear:\n\n```{r}\nmodel <- lm(like ~ fun, data = data_sd)\n\ndate_augmented = data_sd %>% \n  add_predictions(model) %>% \n  add_residuals(model)\n```\nAvaliando os resíduos do modelo:\n\n```{r}\ndate_augmented %>% \n  ggplot(aes(x = fun)) + \n  geom_jitter(aes(y = resid), colour = \"blue\", alpha = .1) +\n  labs(x= \"Diversão\", y = \"Resíduo\") \n```\n\nObservando o gráfico residual, vemos que a maior parte dos erros está entre -3 e 3, dando a entender que o modelo parece representar bem os dados.\n\n```{r}\ntidy(model, conf.int = TRUE) %>% \n  select(-std.error, -p.value) %>%\n  datatable()\n```\n\nA variável diversão (observada sozinha, sem nos importarmos com os efeitos provocados por outras variáveis, especialmente aparência e interesses em comum, que como visto, também parecem ter muita relação) possui um int_corr de aproximadamente 0.64, logo, a cada ponto que acrescemos na nota de diversão, a nota geral tente a aumentar 0.64.\nEsta estimativa é siginificativa, com 95% de confiança.\n\n\n```{r}\nglance(model) %>%\n  datatable()\n```\n\nO modelo é capaz de representar 58% da variação observada em quanto os parceiros foram gostados, da forma que pode ser observada abaixo:\n\n```{r}\ndata_sd %>% \n    add_predictions(model = model) %>% \n    ggplot(aes(x = like, y = fun)) + \n    geom_point(alpha = 0.4) + \n    geom_count() +\n    geom_line(aes(pred), colour = \"blue\") +\n    labs(x= \"Gostou\", y = \"Diversão\")  + \n    NULL\n\n```\n\nLogo, sim! O mundo está certo! Ser divertido parece ser muito importante para atraírmos parceiros.\n\n",
    "created" : 1532605437549.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1113751399",
    "id" : "D711865C",
    "lastKnownWriteTime" : 1533210815,
    "last_content_update" : 1533210815,
    "path" : "~/ad1/romance/5-regressao/speed.Rmd",
    "project_path" : "speed.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}